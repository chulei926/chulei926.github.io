<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dockerfile指令 | 好记性不如烂笔头</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="点点滴滴......">
    
    <link rel="preload" href="/assets/css/0.styles.cf7e09cc.css" as="style"><link rel="preload" href="/assets/js/app.02ff26cb.js" as="script"><link rel="preload" href="/assets/js/2.1d4421e5.js" as="script"><link rel="preload" href="/assets/js/158.a0b852ce.js" as="script"><link rel="prefetch" href="/assets/js/10.2612a63b.js"><link rel="prefetch" href="/assets/js/100.a48a180f.js"><link rel="prefetch" href="/assets/js/101.53f652c1.js"><link rel="prefetch" href="/assets/js/102.f941c746.js"><link rel="prefetch" href="/assets/js/103.e2c01416.js"><link rel="prefetch" href="/assets/js/104.db10e5e4.js"><link rel="prefetch" href="/assets/js/105.f64703cf.js"><link rel="prefetch" href="/assets/js/106.730f3f66.js"><link rel="prefetch" href="/assets/js/107.54511dfb.js"><link rel="prefetch" href="/assets/js/108.a62067f6.js"><link rel="prefetch" href="/assets/js/109.481f1a0c.js"><link rel="prefetch" href="/assets/js/11.803e259d.js"><link rel="prefetch" href="/assets/js/110.7b60026a.js"><link rel="prefetch" href="/assets/js/111.161406e0.js"><link rel="prefetch" href="/assets/js/112.fca5c042.js"><link rel="prefetch" href="/assets/js/113.3f8f95cc.js"><link rel="prefetch" href="/assets/js/114.db8f0937.js"><link rel="prefetch" href="/assets/js/115.262c0345.js"><link rel="prefetch" href="/assets/js/116.48b3a53a.js"><link rel="prefetch" href="/assets/js/117.d5dffc63.js"><link rel="prefetch" href="/assets/js/118.bf748590.js"><link rel="prefetch" href="/assets/js/119.3661e3b4.js"><link rel="prefetch" href="/assets/js/12.587a49fb.js"><link rel="prefetch" href="/assets/js/120.3b9af04e.js"><link rel="prefetch" href="/assets/js/121.07d65a74.js"><link rel="prefetch" href="/assets/js/122.2c55b5b6.js"><link rel="prefetch" href="/assets/js/123.d58733a7.js"><link rel="prefetch" href="/assets/js/124.fb4bb339.js"><link rel="prefetch" href="/assets/js/125.58dfb2a3.js"><link rel="prefetch" href="/assets/js/126.2a67695a.js"><link rel="prefetch" href="/assets/js/127.a78041c0.js"><link rel="prefetch" href="/assets/js/128.2983e5fa.js"><link rel="prefetch" href="/assets/js/129.8e49184d.js"><link rel="prefetch" href="/assets/js/13.05e41973.js"><link rel="prefetch" href="/assets/js/130.86d1a471.js"><link rel="prefetch" href="/assets/js/131.369ed59a.js"><link rel="prefetch" href="/assets/js/132.4a02b6ad.js"><link rel="prefetch" href="/assets/js/133.cc55147a.js"><link rel="prefetch" href="/assets/js/134.a630640a.js"><link rel="prefetch" href="/assets/js/135.266d4b52.js"><link rel="prefetch" href="/assets/js/136.2b913d1e.js"><link rel="prefetch" href="/assets/js/137.6cde93a7.js"><link rel="prefetch" href="/assets/js/138.fd2a41be.js"><link rel="prefetch" href="/assets/js/139.03960fc4.js"><link rel="prefetch" href="/assets/js/14.c08aeef1.js"><link rel="prefetch" href="/assets/js/140.57152984.js"><link rel="prefetch" href="/assets/js/141.85d648d0.js"><link rel="prefetch" href="/assets/js/142.bc367f2b.js"><link rel="prefetch" href="/assets/js/143.8659f21e.js"><link rel="prefetch" href="/assets/js/144.17d93cf7.js"><link rel="prefetch" href="/assets/js/145.c2a1734a.js"><link rel="prefetch" href="/assets/js/146.3bea7107.js"><link rel="prefetch" href="/assets/js/147.5191bc26.js"><link rel="prefetch" href="/assets/js/148.0b213fd3.js"><link rel="prefetch" href="/assets/js/149.b67b1a8c.js"><link rel="prefetch" href="/assets/js/15.b0532791.js"><link rel="prefetch" href="/assets/js/150.786fee79.js"><link rel="prefetch" href="/assets/js/151.c5f449a7.js"><link rel="prefetch" href="/assets/js/152.5179aa50.js"><link rel="prefetch" href="/assets/js/153.9d71a144.js"><link rel="prefetch" href="/assets/js/154.91a718e4.js"><link rel="prefetch" href="/assets/js/155.a35decd8.js"><link rel="prefetch" href="/assets/js/156.24bf2272.js"><link rel="prefetch" href="/assets/js/157.0d5c3349.js"><link rel="prefetch" href="/assets/js/159.6f4f8566.js"><link rel="prefetch" href="/assets/js/16.eb74b9fc.js"><link rel="prefetch" href="/assets/js/160.3e6210d4.js"><link rel="prefetch" href="/assets/js/161.cbe1b2e4.js"><link rel="prefetch" href="/assets/js/162.7a7dbffe.js"><link rel="prefetch" href="/assets/js/163.2f363052.js"><link rel="prefetch" href="/assets/js/164.9396e5f5.js"><link rel="prefetch" href="/assets/js/165.5bc2c683.js"><link rel="prefetch" href="/assets/js/166.d407d438.js"><link rel="prefetch" href="/assets/js/167.b67b05d5.js"><link rel="prefetch" href="/assets/js/168.f2bb3219.js"><link rel="prefetch" href="/assets/js/169.84da5917.js"><link rel="prefetch" href="/assets/js/17.741cfbb0.js"><link rel="prefetch" href="/assets/js/170.9defeadc.js"><link rel="prefetch" href="/assets/js/171.8558ceeb.js"><link rel="prefetch" href="/assets/js/172.27ab3775.js"><link rel="prefetch" href="/assets/js/173.8e2caed0.js"><link rel="prefetch" href="/assets/js/174.9789a06a.js"><link rel="prefetch" href="/assets/js/175.bad616a7.js"><link rel="prefetch" href="/assets/js/176.8aea3af4.js"><link rel="prefetch" href="/assets/js/177.ffb64381.js"><link rel="prefetch" href="/assets/js/178.79196e1e.js"><link rel="prefetch" href="/assets/js/179.b5eb5905.js"><link rel="prefetch" href="/assets/js/18.4a44f169.js"><link rel="prefetch" href="/assets/js/180.26ab9357.js"><link rel="prefetch" href="/assets/js/181.02dc4b39.js"><link rel="prefetch" href="/assets/js/182.9531c034.js"><link rel="prefetch" href="/assets/js/183.089abd3d.js"><link rel="prefetch" href="/assets/js/184.b4e5548b.js"><link rel="prefetch" href="/assets/js/185.3043b77e.js"><link rel="prefetch" href="/assets/js/186.4b71766a.js"><link rel="prefetch" href="/assets/js/187.5b075d35.js"><link rel="prefetch" href="/assets/js/188.9310608e.js"><link rel="prefetch" href="/assets/js/189.75347d4c.js"><link rel="prefetch" href="/assets/js/19.a4b90c6e.js"><link rel="prefetch" href="/assets/js/190.b0b40c7e.js"><link rel="prefetch" href="/assets/js/191.31fc85a1.js"><link rel="prefetch" href="/assets/js/192.0baa5723.js"><link rel="prefetch" href="/assets/js/193.a6a5d7af.js"><link rel="prefetch" href="/assets/js/194.9928bfb5.js"><link rel="prefetch" href="/assets/js/195.4f236cfe.js"><link rel="prefetch" href="/assets/js/196.a491a611.js"><link rel="prefetch" href="/assets/js/197.06248b7d.js"><link rel="prefetch" href="/assets/js/198.27883039.js"><link rel="prefetch" href="/assets/js/199.70f7d749.js"><link rel="prefetch" href="/assets/js/20.f62001e7.js"><link rel="prefetch" href="/assets/js/200.cbd0fbd8.js"><link rel="prefetch" href="/assets/js/201.06d814ed.js"><link rel="prefetch" href="/assets/js/202.d2b37a38.js"><link rel="prefetch" href="/assets/js/203.891bb359.js"><link rel="prefetch" href="/assets/js/204.43382f90.js"><link rel="prefetch" href="/assets/js/205.27f0c70a.js"><link rel="prefetch" href="/assets/js/206.c06459c5.js"><link rel="prefetch" href="/assets/js/207.e5aed09f.js"><link rel="prefetch" href="/assets/js/208.6c8af03b.js"><link rel="prefetch" href="/assets/js/209.bd1f9c26.js"><link rel="prefetch" href="/assets/js/21.3562d3d3.js"><link rel="prefetch" href="/assets/js/210.529d4422.js"><link rel="prefetch" href="/assets/js/211.a63631c3.js"><link rel="prefetch" href="/assets/js/212.fc77d568.js"><link rel="prefetch" href="/assets/js/213.1a02e45e.js"><link rel="prefetch" href="/assets/js/214.5ee9c099.js"><link rel="prefetch" href="/assets/js/215.9ff39c1a.js"><link rel="prefetch" href="/assets/js/216.3b4534b6.js"><link rel="prefetch" href="/assets/js/217.986feb3b.js"><link rel="prefetch" href="/assets/js/218.e95f7d08.js"><link rel="prefetch" href="/assets/js/219.1d05bf16.js"><link rel="prefetch" href="/assets/js/22.791a3b70.js"><link rel="prefetch" href="/assets/js/220.d38cf748.js"><link rel="prefetch" href="/assets/js/221.7a0d2305.js"><link rel="prefetch" href="/assets/js/23.a6390e10.js"><link rel="prefetch" href="/assets/js/24.15f0e4ae.js"><link rel="prefetch" href="/assets/js/25.2606ffab.js"><link rel="prefetch" href="/assets/js/26.c2c78091.js"><link rel="prefetch" href="/assets/js/27.e5e56c89.js"><link rel="prefetch" href="/assets/js/28.8eb6838b.js"><link rel="prefetch" href="/assets/js/29.c1bec995.js"><link rel="prefetch" href="/assets/js/3.d4d79f5a.js"><link rel="prefetch" href="/assets/js/30.8af808f7.js"><link rel="prefetch" href="/assets/js/31.e52b65d7.js"><link rel="prefetch" href="/assets/js/32.965ec6ed.js"><link rel="prefetch" href="/assets/js/33.1f6e42aa.js"><link rel="prefetch" href="/assets/js/34.6e9f4128.js"><link rel="prefetch" href="/assets/js/35.d91ff803.js"><link rel="prefetch" href="/assets/js/36.e61d3e6a.js"><link rel="prefetch" href="/assets/js/37.a4e611d2.js"><link rel="prefetch" href="/assets/js/38.ccc9d6f3.js"><link rel="prefetch" href="/assets/js/39.8608b7da.js"><link rel="prefetch" href="/assets/js/4.f41ae6ac.js"><link rel="prefetch" href="/assets/js/40.7c59b19a.js"><link rel="prefetch" href="/assets/js/41.590a7469.js"><link rel="prefetch" href="/assets/js/42.eb3aeb28.js"><link rel="prefetch" href="/assets/js/43.b64c90ff.js"><link rel="prefetch" href="/assets/js/44.98bed8f2.js"><link rel="prefetch" href="/assets/js/45.8826e61d.js"><link rel="prefetch" href="/assets/js/46.9bceeda9.js"><link rel="prefetch" href="/assets/js/47.f065a06b.js"><link rel="prefetch" href="/assets/js/48.7c56607f.js"><link rel="prefetch" href="/assets/js/49.1d37d6d2.js"><link rel="prefetch" href="/assets/js/5.e94f6fbf.js"><link rel="prefetch" href="/assets/js/50.1f1975f8.js"><link rel="prefetch" href="/assets/js/51.cc7be6a6.js"><link rel="prefetch" href="/assets/js/52.233e537c.js"><link rel="prefetch" href="/assets/js/53.3e3bb76c.js"><link rel="prefetch" href="/assets/js/54.0280fb6c.js"><link rel="prefetch" href="/assets/js/55.8b329502.js"><link rel="prefetch" href="/assets/js/56.d77fd488.js"><link rel="prefetch" href="/assets/js/57.3ca344a2.js"><link rel="prefetch" href="/assets/js/58.2d661ed6.js"><link rel="prefetch" href="/assets/js/59.5c502d91.js"><link rel="prefetch" href="/assets/js/6.1439bad9.js"><link rel="prefetch" href="/assets/js/60.57dd9a6d.js"><link rel="prefetch" href="/assets/js/61.117d3e5c.js"><link rel="prefetch" href="/assets/js/62.c9af0cf0.js"><link rel="prefetch" href="/assets/js/63.100ada63.js"><link rel="prefetch" href="/assets/js/64.2d39cca9.js"><link rel="prefetch" href="/assets/js/65.c258fe53.js"><link rel="prefetch" href="/assets/js/66.063768cf.js"><link rel="prefetch" href="/assets/js/67.48cc8fe4.js"><link rel="prefetch" href="/assets/js/68.0c97995d.js"><link rel="prefetch" href="/assets/js/69.f3bbc9a1.js"><link rel="prefetch" href="/assets/js/7.b73cdc82.js"><link rel="prefetch" href="/assets/js/70.4eece393.js"><link rel="prefetch" href="/assets/js/71.50c7f81a.js"><link rel="prefetch" href="/assets/js/72.06cb4218.js"><link rel="prefetch" href="/assets/js/73.629b59e6.js"><link rel="prefetch" href="/assets/js/74.d94d295f.js"><link rel="prefetch" href="/assets/js/75.ff67a5d5.js"><link rel="prefetch" href="/assets/js/76.39d3f3d3.js"><link rel="prefetch" href="/assets/js/77.719a41df.js"><link rel="prefetch" href="/assets/js/78.4b3f35c4.js"><link rel="prefetch" href="/assets/js/79.3951bc7d.js"><link rel="prefetch" href="/assets/js/8.50d6eed6.js"><link rel="prefetch" href="/assets/js/80.032c9956.js"><link rel="prefetch" href="/assets/js/81.2b7dae7c.js"><link rel="prefetch" href="/assets/js/82.094b3eb6.js"><link rel="prefetch" href="/assets/js/83.6cacd4fc.js"><link rel="prefetch" href="/assets/js/84.c1cf089a.js"><link rel="prefetch" href="/assets/js/85.3c0bad68.js"><link rel="prefetch" href="/assets/js/86.c6baa876.js"><link rel="prefetch" href="/assets/js/87.533ce502.js"><link rel="prefetch" href="/assets/js/88.aef39485.js"><link rel="prefetch" href="/assets/js/89.d0353977.js"><link rel="prefetch" href="/assets/js/9.fd60f076.js"><link rel="prefetch" href="/assets/js/90.cc69fcd9.js"><link rel="prefetch" href="/assets/js/91.5f3fbe08.js"><link rel="prefetch" href="/assets/js/92.252d52a6.js"><link rel="prefetch" href="/assets/js/93.274b0c49.js"><link rel="prefetch" href="/assets/js/94.9178043a.js"><link rel="prefetch" href="/assets/js/95.c5f98c00.js"><link rel="prefetch" href="/assets/js/96.7ea78c21.js"><link rel="prefetch" href="/assets/js/97.a9f10c4b.js"><link rel="prefetch" href="/assets/js/98.e8276e33.js"><link rel="prefetch" href="/assets/js/99.cd384db4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cf7e09cc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="好记性不如烂笔头" class="logo"> <span class="site-name can-hide">好记性不如烂笔头</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/01-java/config/" class="nav-link">
  常用配置
</a></li><li class="dropdown-subitem"><a href="/01-java/snippet/" class="nav-link">
  代码片段
</a></li><li class="dropdown-subitem"><a href="/01-java/jdk8/" class="nav-link">
  jdk8
</a></li><li class="dropdown-subitem"><a href="/01-java/jvm/" class="nav-link">
  jvm
</a></li><li class="dropdown-subitem"><a href="/01-java/src/" class="nav-link">
  源码学习
</a></li></ul></li><li class="dropdown-item"><h4>
          Framework
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/01-java/Tomcat/" class="nav-link">
  Tomcat
</a></li><li class="dropdown-subitem"><a href="/01-java/bio&amp;nio&amp;netty/" class="nav-link">
  Netty
</a></li><li class="dropdown-subitem"><a href="/01-java/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/01-java/dubbo/" class="nav-link">
  Dubbo
</a></li><li class="dropdown-subitem"><a href="/01-java/cas/" class="nav-link">
  CAS
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/02-数据库/mysql/" class="nav-link">
  MySQL
</a></li></ul></li><li class="dropdown-item"><h4>
          非关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/02-数据库/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/02-数据库/mongodb/" class="nav-link">
  MongoDB
</a></li><li class="dropdown-subitem"><a href="/02-数据库/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03-前端/node/" class="nav-link">
  NodeJs
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/Angular/" class="nav-link">
  Angular
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/pm2/" class="nav-link">
  PM2
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/other/" class="nav-link">
  other
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/04-运维/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/04-运维/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/04-运维/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/04-运维/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><a href="/06-python/" class="nav-link">
  python
</a></div><div class="nav-item"><a href="/07-golang/" class="nav-link">
  golang
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/08-大数据/Zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/HBASE/" class="nav-link">
  Hbase
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/kafka/" class="nav-link">
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/scala/" class="nav-link">
  Scala
</a></li></ul></div></div><div class="nav-item"><a href="/other/" class="nav-link">
  杂货铺
</a></div><div class="nav-item"><a href="https://github.com/chulei926" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/01-java/config/" class="nav-link">
  常用配置
</a></li><li class="dropdown-subitem"><a href="/01-java/snippet/" class="nav-link">
  代码片段
</a></li><li class="dropdown-subitem"><a href="/01-java/jdk8/" class="nav-link">
  jdk8
</a></li><li class="dropdown-subitem"><a href="/01-java/jvm/" class="nav-link">
  jvm
</a></li><li class="dropdown-subitem"><a href="/01-java/src/" class="nav-link">
  源码学习
</a></li></ul></li><li class="dropdown-item"><h4>
          Framework
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/01-java/Tomcat/" class="nav-link">
  Tomcat
</a></li><li class="dropdown-subitem"><a href="/01-java/bio&amp;nio&amp;netty/" class="nav-link">
  Netty
</a></li><li class="dropdown-subitem"><a href="/01-java/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/01-java/dubbo/" class="nav-link">
  Dubbo
</a></li><li class="dropdown-subitem"><a href="/01-java/cas/" class="nav-link">
  CAS
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/02-数据库/mysql/" class="nav-link">
  MySQL
</a></li></ul></li><li class="dropdown-item"><h4>
          非关系型
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/02-数据库/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/02-数据库/mongodb/" class="nav-link">
  MongoDB
</a></li><li class="dropdown-subitem"><a href="/02-数据库/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/03-前端/node/" class="nav-link">
  NodeJs
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/Angular/" class="nav-link">
  Angular
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/pm2/" class="nav-link">
  PM2
</a></li><li class="dropdown-item"><!----> <a href="/03-前端/other/" class="nav-link">
  other
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><span class="title">运维</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维" class="mobile-dropdown-title"><span class="title">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/04-运维/Linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/04-运维/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/04-运维/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/04-运维/other/" class="nav-link">
  其他
</a></li></ul></div></div><div class="nav-item"><a href="/06-python/" class="nav-link">
  python
</a></div><div class="nav-item"><a href="/07-golang/" class="nav-link">
  golang
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/08-大数据/Zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/Hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/HBASE/" class="nav-link">
  Hbase
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/kafka/" class="nav-link">
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/08-大数据/scala/" class="nav-link">
  Scala
</a></li></ul></div></div><div class="nav-item"><a href="/other/" class="nav-link">
  杂货铺
</a></div><div class="nav-item"><a href="https://github.com/chulei926" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/04-运维/docker/000-docker基础.html" class="sidebar-link">基础</a></li><li><a href="/04-运维/docker/001-docker安装.html" class="sidebar-link">安装</a></li><li><a href="/04-运维/docker/003-docker搭建私有仓库.html" class="sidebar-link">私有仓库</a></li><li><a href="/04-运维/docker/004-docker命令.html" class="sidebar-link">docker help</a></li><li><a href="/04-运维/docker/005-docker常用命令.html" class="sidebar-link">常用命令</a></li><li><a href="/04-运维/docker/006-Dockerfile指令.html" class="active sidebar-link">Dockerfile指令</a></li><li><a href="/04-运维/docker/007-Dockerfile各种构建.html" class="sidebar-link">Dockerfile各种构建</a></li><li><a href="/04-运维/docker/008-java-war包部署.html" class="sidebar-link">java-war包部署</a></li><li><a href="/04-运维/docker/009-nexus私服安装.html" class="sidebar-link">nexus私服安装</a></li><li><a href="/04-运维/docker/010-pandoc加入docker.html" class="sidebar-link">pandoc加入docker</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dockerfile指令"><a href="#dockerfile指令" class="header-anchor">#</a> Dockerfile指令</h1> <h2 id="from-指定基础镜像"><a href="#from-指定基础镜像" class="header-anchor">#</a> FROM 指定基础镜像</h2> <ul><li>所谓定制镜像，那一定是以一个镜像为基础，在其上进行定制。</li> <li>一个 Dockerfile 中 FROM 是必备的指令，并且必须是第一条指令。</li></ul> <p>除了选择现有镜像为基础镜像外，Docker 还存在一个特殊的镜像，名为 scratch。这个镜像是虚拟的概念，并不实际存在，它表示一个空白的镜像。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>FROM scratch
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果你以 scratch 为基础镜像的话，意味着你不以任何镜像为基础，接下来所写的指令将作为镜像第一层开始存在。<br>
不以任何系统为基础，直接将可执行文件复制进镜像的做法并不罕见，比如 swarm、etcd。<br>
对于 Linux 下静态编译的程序来说，并不需要有操作系统提供运行时支持，所需的一切库都已经在可执行文件里了，因此直接 FROM scratch 会让镜像体积更加小巧。<br>
使用 Go 语言 开发的应用很多会使用这种方式来制作镜像，这也是为什么有人认为 Go 是特别适合容器微服务架构的语言的原因之一。</p> <h2 id="run-执行命令"><a href="#run-执行命令" class="header-anchor">#</a> RUN 执行命令</h2> <p>RUN 指令是用来执行命令行命令的。由于命令行的强大能力，RUN 指令在定制镜像时是最常用的指令之一。其格式有两种：</p> <ul><li>shell 格式：RUN &lt;命令&gt;，就像直接在命令行中输入的命令一样。<div class="language-shell line-numbers-mode"><pre class="language-shell"><code>RUN <span class="token builtin class-name">echo</span> <span class="token string">'&lt;h1&gt;Hello, Docker!&lt;/h1&gt;'</span> <span class="token operator">&gt;</span> /usr/share/nginx/html/index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li>exec 格式：RUN [&quot;可执行文件&quot;, &quot;参数1&quot;, &quot;参数2&quot;]，这更像是函数调用中的格式。<div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h2 id="copy-复制文件"><a href="#copy-复制文件" class="header-anchor">#</a> COPY 复制文件</h2> <p>格式：</p> <ul><li><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;源路径&gt;... &lt;目标路径&gt;</code></li> <li><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] [&quot;&lt;源路径1&gt;&quot;,... &quot;&lt;目标路径&gt;&quot;]</code></li></ul> <blockquote><p>和 RUN 指令一样，也有两种格式，一种类似于命令行，一种类似于函数调用。</p></blockquote> <p>COPY 指令将从构建上下文目录中 &lt;源路径&gt; 的文件/目录复制到新的一层的镜像内的 &lt;目标路径&gt; 位置。比如：<br></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>COPY package.json /usr/src/app/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>&lt;源路径&gt;</code> 可以是多个，甚至可以是通配符，其通配符规则要满足 Go 的 filepath.Match 规则，如：<br></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>COPY hom* /mydir/
COPY hom?.txt /mydir/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>&lt;目标路径&gt;</code> 可以是容器内的绝对路径，也可以是相对于工作目录的相对路径（工作目录可以用 WORKDIR 指令来指定）。目标路径不需要事先创建，如果目录不存在会在复制文件前先行创建缺失目录。</p> <p>此外，还需要注意一点，使用 COPY 指令，源文件的各种元数据都会保留。比如读、写、执行权限、文件变更时间等。这个特性对于镜像定制很有用。特别是构建相关文件都在使用 Git 进行管理的时候。</p> <p>在使用该指令的时候还可以加上 <code>--chown=&lt;user&gt;:&lt;group&gt;</code> 选项来改变文件的所属用户及所属组。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>COPY --chown=55:mygroup files* /mydir/
COPY --chown=bin files* /mydir/
COPY --chown=1 files* /mydir/
COPY --chown=10:11 files* /mydir/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="add-更高级的复制文件"><a href="#add-更高级的复制文件" class="header-anchor">#</a> ADD 更高级的复制文件</h2> <p><code>ADD</code> 指令和 <code>COPY</code> 的格式和性质基本一致。但是在 <code>COPY</code> 基础上增加了一些功能。</p> <p>比如 &lt;源路径&gt; 可以是一个 URL，这种情况下，Docker 引擎会试图去下载这个链接的文件放到 &lt;目标路径&gt; 去。下载后的文件权限自动设置为 600，如果这并不是想要的权限，那么还需要增加额外的一层 RUN 进行权限调整，另外，如果下载的是个压缩包，需要解压缩，也一样还需要额外的一层 RUN 指令进行解压缩。所以不如直接使用 RUN 指令，然后使用 wget 或者 curl 工具下载，处理权限、解压缩、然后清理无用文件更合理。因此，这个功能其实并不实用，而且不推荐使用。</p> <p>如果 &lt;源路径&gt; 为一个 tar 压缩文件的话，压缩格式为 gzip, bzip2 以及 xz 的情况下，ADD 指令将会自动解压缩这个压缩文件到 &lt;目标路径&gt; 去。</p> <p>在某些情况下，这个自动解压缩的功能非常有用，比如官方镜像 ubuntu 中：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>FROM scratch
ADD ubuntu-xenial-core-cloudimg-amd64-root.tar.gz /
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>但在某些情况下，如果我们真的是希望复制个压缩文件进去，而不解压缩，这时就不可以使用 ADD 命令了。</p> <p>在 Docker 官方的 Dockerfile 最佳实践文档 中要求，尽可能的使用 COPY，因为 COPY 的语义很明确，就是复制文件而已，而 ADD 则包含了更复杂的功能，其行为也不一定很清晰。最适合使用 ADD 的场合，就是所提及的需要自动解压缩的场合。</p> <p>另外需要注意的是，ADD 指令会令镜像构建缓存失效，从而可能会令镜像构建变得比较缓慢。</p> <p>因此在 COPY 和 ADD 指令中选择的时候，可以遵循这样的原则，所有的文件复制均使用 COPY 指令，仅在需要自动解压缩的场合使用 ADD。</p> <p>在使用该指令的时候还可以加上 <code>--chown=&lt;user&gt;:&lt;group&gt;</code> 选项来改变文件的所属用户及所属组。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ADD --chown<span class="token operator">=</span><span class="token number">55</span>:mygroup files* /mydir/
ADD --chown<span class="token operator">=</span>bin files* /mydir/
ADD --chown<span class="token operator">=</span><span class="token number">1</span> files* /mydir/
ADD --chown<span class="token operator">=</span><span class="token number">10</span>:11 files* /mydir/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="cmd-容器启动命令"><a href="#cmd-容器启动命令" class="header-anchor">#</a> CMD 容器启动命令</h2> <p>CMD 指令的格式和 RUN 相似，也是两种格式：</p> <ul><li>shell 格式：<code>CMD &lt;命令&gt;</code></li> <li>exec 格式：<code>CMD [&quot;可执行文件&quot;, &quot;参数1&quot;, &quot;参数2&quot;...]</code></li> <li>参数列表格式：CMD [&quot;参数1&quot;, &quot;参数2&quot;...]。在指定了 ENTRYPOINT 指令后，用 CMD 指定具体的参数。</li></ul> <p>Docker 不是虚拟机，容器就是进程。既然是进程，那么在启动容器的时候，需要指定所运行的程序及参数。CMD 指令就是用于指定默认的容器主进程的启动命令的。</p> <p>在运行时可以指定新的命令来替代镜像设置中的这个默认命令，比如，ubuntu 镜像默认的 CMD 是 <code>/bin/bash</code>，如果我们直接 <code>docker run -it ubuntu</code> 的话，会直接进入 bash。我们也可以在运行时指定运行别的命令，如 <code>docker run -it ubuntu cat /etc/os-release</code>。这就是用 <code>cat /etc/os-release</code> 命令替换了默认的 <code>/bin/bash</code> 命令了，输出了系统版本信息。</p> <p>在指令格式上，一般推荐使用 exec 格式，这类格式在解析时会被解析为 JSON 数组，因此一定要使用双引号 &quot;，而不要使用单引号。</p> <p>如果使用 shell 格式的话，实际的命令会被包装为 sh -c 的参数的形式进行执行。比如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>CMD <span class="token builtin class-name">echo</span> <span class="token environment constant">$HOME</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在实际执行中，会将其变更为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>CMD <span class="token punctuation">[</span> <span class="token string">&quot;sh&quot;</span>, <span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo <span class="token environment constant">$HOME</span>&quot;</span> <span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这就是为什么可以使用环境变量的原因，因为这些环境变量会被 shell 进行解析处理。</p> <h2 id="entrypoint-入口点"><a href="#entrypoint-入口点" class="header-anchor">#</a> ENTRYPOINT 入口点</h2> <p>ENTRYPOINT 的格式和 RUN 指令格式一样，分为 exec 格式和 shell 格式。</p> <p>ENTRYPOINT 的目的和 CMD 一样，都是在指定容器启动程序及参数。ENTRYPOINT 在运行时也可以替代，不过比 CMD 要略显繁琐，需要通过 <code>docker run</code> 的参数 <code>--entrypoint</code> 来指定。</p> <p>当指定了 ENTRYPOINT 后，CMD 的含义就发生了改变，不再是直接的运行其命令，而是将 CMD 的内容作为参数传给 ENTRYPOINT 指令，换句话说实际执行时，将变为：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&lt;</span>ENTRYPOINT<span class="token operator">&gt;</span> <span class="token string">&quot;&lt;CMD&gt;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2021-05-05 20:24:13</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/04-运维/docker/005-docker常用命令.html" class="prev">
        常用命令
      </a></span> <span class="next"><a href="/04-运维/docker/007-Dockerfile各种构建.html">
        Dockerfile各种构建
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.02ff26cb.js" defer></script><script src="/assets/js/2.1d4421e5.js" defer></script><script src="/assets/js/158.a0b852ce.js" defer></script>
  </body>
</html>
