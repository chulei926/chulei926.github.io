(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{518:function(s,a,t){"use strict";t.r(a);var e=t(22),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"私有仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#私有仓库"}},[s._v("#")]),s._v(" 私有仓库")]),s._v(" "),t("h2",{attrs:{id:"下载镜像registry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载镜像registry"}},[s._v("#")]),s._v(" 下载镜像registry")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ docker pull registry\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ docker run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(":5000 --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always --name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("registry-srv -v /mnt/dockerRegistry:/var/lib/registry registry\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##    -d：后台运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##    -p：将容器的5000端口映射到宿主机的5000端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##    --restart：docker服务重启后总是重启此容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##    --name：容器的名称")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##    -v：将容器内的/var/lib/registry映射到宿主机的/mnt/dockerRegistry目录")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"搭建web服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搭建web服务"}},[s._v("#")]),s._v(" 搭建WEB服务")]),s._v(" "),t("h3",{attrs:{id:"下载镜像registry-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载镜像registry-2"}},[s._v("#")]),s._v(" 下载镜像registry")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ docker pull hyper/docker-registry-web\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"启动容器-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动容器-2"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ docker run -it -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always --name registry-web --link registry-srv -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REGISTRY_URL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://registry-srv:5000/v2 -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REGISTRY_NAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost:5000 hyper/docker-registry-web\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("-it: 以交互模式运行\n--link：链接其它容器(registry-srv)，在此容器中，使用registry-srv等同于registry-srv容器的局域网地址\n-e：设置环境变量\n")])])]),t("hr"),s._v(" "),t("h3",{attrs:{id:"在另一台机器上配置-docker-仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在另一台机器上配置-docker-仓库"}},[s._v("#")]),s._v(" 在另一台机器上配置 docker 仓库")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 编辑 /etc/docker/daemon.json")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirror"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.docker-cn.com"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"insecure-registries"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[私有仓库 ip:port]"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 重启 docker 服务")]),s._v("\n$ systemctl restart docker\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);